<!--
  ~ MIT License
  ~
  ~ Copyright (c) 2024 Hongtao Liu
  ~
  ~ Permission is hereby granted, free of charge, to any person obtaining a copy
  ~ of this software and associated documentation files (the "Software"), to deal
  ~ in the Software without restriction, including without limitation the rights
  ~ to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  ~ copies of the Software, and to permit persons to whom the Software is
  ~ furnished to do so, subject to the following conditions:
  ~
  ~ The above copyright notice and this permission notice shall be included in all
  ~ copies or substantial portions of the Software.
  ~
  ~ THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  ~ IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  ~ FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  ~ AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  ~ LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  ~ OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  ~ SOFTWARE.
  ~
  -->

<div nz-popover [nzPopoverTrigger]="trigger" [nzPopoverContent]="searchContent"
     [(nzPopoverVisible)]="visible" (nzPopoverVisibleChange)="changeTrigger($event)">
    <nz-input-group [nzSuffix]="suffixTemplate">
        <input [(ngModel)]="keyword" class="search-input" type="text" nz-input
               placeholder="请输入申请编号" (input)="keywordChange()"/>
    </nz-input-group>
    <ng-template #suffixTemplate><span nz-icon nzType="search" (click)="keywordSearch()"></span></ng-template>
</div>
<ng-template #searchContent>
    <nz-spin [nzSpinning]="fetching">
        @if (list.length > 0) {
            <ul class="search-input">
                @for (item of list; track item.id) {
                    <li>
                        <a (click)="routeToDetails(item.id)"> <!-- 跳转到详情页 -->
                            <h3 class="ellipsis">申请人: {{ item.starterName }}</h3>
                            <div>单号: {{ item.id }}</div>
                        </a>
                    </li>
                }
            </ul>
        } @else {
            <nz-empty class="search-input"></nz-empty>
        }
    </nz-spin>
</ng-template>
