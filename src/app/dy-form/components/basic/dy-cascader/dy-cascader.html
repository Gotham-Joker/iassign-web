<!--
  ~ MIT License
  ~
  ~ Copyright (c) 2024 Hongtao Liu
  ~
  ~ Permission is hereby granted, free of charge, to any person obtaining a copy
  ~ of this software and associated documentation files (the "Software"), to deal
  ~ in the Software without restriction, including without limitation the rights
  ~ to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  ~ copies of the Software, and to permit persons to whom the Software is
  ~ furnished to do so, subject to the following conditions:
  ~
  ~ The above copyright notice and this permission notice shall be included in all
  ~ copies or substantial portions of the Software.
  ~
  ~ THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  ~ IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  ~ FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  ~ AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  ~ LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  ~ OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  ~ SOFTWARE.
  ~
  -->

<nz-form-item>
    <nz-form-label [nzSpan]="config.labelSpan" [nzNoColon]="config.noColon"
                   [nzRequired]="config.required">{{ config.label }}
    </nz-form-label>
    <nz-form-control [nzValidateStatus]="status" [nzSpan]="config.span" [nzErrorTip]="config.msg">
        <nz-cascader [(ngModel)]="config.value"></nz-cascader>
    </nz-form-control>
</nz-form-item>

<ng-template #cfgTpl>
    <nz-tabset [(nzSelectedIndex)]="config.tabIndex">
        <nz-tab nzTitle="外观">
            <nz-form-item>
                <nz-form-label nzRequired>字段</nz-form-label>
                <nz-form-control>
                    <input nz-input [(ngModel)]="config.field" placeholder="field(表单内唯一)">
                </nz-form-control>
            </nz-form-item>
            <nz-form-item>
                <nz-form-label>控件标签</nz-form-label>
                <nz-form-control>
                    <input nz-input [(ngModel)]="config.label" placeholder="请输入标签">
                </nz-form-control>
            </nz-form-item>

            <nz-form-item>
                <nz-form-label>栅格宽度</nz-form-label>
                <nz-form-control>
                    <nz-input-number style="width: 100%" [nzMin]="0" [nzMax]="24"
                                     [(ngModel)]="config.dyColSpan"></nz-input-number>
                </nz-form-control>
            </nz-form-item>

            <nz-form-item>
                <nz-form-label>标签宽度</nz-form-label>
                <nz-form-control>
                    <nz-input-number style="width: 100%" [nzMin]="0" [nzMax]="24"
                                     [(ngModel)]="config.labelSpan"></nz-input-number>
                </nz-form-control>
            </nz-form-item>

            <nz-form-item>
                <nz-form-label>控件宽度</nz-form-label>
                <nz-form-control>
                    <nz-input-number style="width: 100%" [nzMin]="0" [nzMax]="24"
                                     [(ngModel)]="config.span"></nz-input-number>
                </nz-form-control>
            </nz-form-item>
            <nz-form-item>
                <nz-form-label>必填</nz-form-label>
                <nz-form-control>
                    <nz-switch [(ngModel)]="config.required"></nz-switch>
                </nz-form-control>
                <nz-form-label>只读</nz-form-label>
                <nz-form-control>
                    <nz-switch [(ngModel)]="config.readOnly"></nz-switch>
                </nz-form-control>
            </nz-form-item>
            <nz-form-item>
                <nz-form-label>隐藏冒号</nz-form-label>
                <nz-form-control>
                    <nz-switch [(ngModel)]="config.noColon"></nz-switch>
                </nz-form-control>
            </nz-form-item>
            <nz-divider nzPlain nzText="校验" nzOrientation="center"></nz-divider>
            <nz-form-item>
                <nz-form-label>minLength</nz-form-label>
                <nz-form-control>
                    <nz-input-number [nzMin]="0" [(ngModel)]="config.minLength"/>
                </nz-form-control>
            </nz-form-item>
            <nz-form-item>
                <nz-form-label>maxLength</nz-form-label>
                <nz-form-control>
                    <nz-input-number [nzMin]="0" [(ngModel)]="config.maxLength"/>
                </nz-form-control>
            </nz-form-item>
            <nz-form-item>
                <nz-form-label>正则</nz-form-label>
                <nz-form-control>
                    <input nz-input [(ngModel)]="config.regex"/>
                </nz-form-control>
            </nz-form-item>
            <nz-form-item>
                <nz-form-label>错误提示</nz-form-label>
                <nz-form-control>
                    <input nz-input [(ngModel)]="config.msg"/>
                </nz-form-control>
            </nz-form-item>
            <nz-form-item>
                <button nz-button nzType="primary" nzBlock (click)="validate()">验证</button>
            </nz-form-item>
        </nz-tab>

        <nz-tab nzTitle="高级">
            <nz-divider nzPlain nzText="数据源" nzOrientation="center"></nz-divider>
            <p>url中可以用$$表示选中的value，以便懒加载子节点</p>
            <nz-form-item>
                <nz-form-label>URL</nz-form-label>
                <nz-form-control>
                    <input nz-input placeholder="/api/user?p=$$" [(ngModel)]="config.url">
                </nz-form-control>
            </nz-form-item>
            <nz-form-item>
                <nz-form-label>$$默认值</nz-form-label>
                <nz-form-control>
                    <input nz-input [(ngModel)]="config.dv">
                </nz-form-control>
            </nz-form-item>
            <nz-form-item>
                <nz-form-label>响应字段</nz-form-label>
                <nz-form-control>
                    <input nz-input placeholder="eg: data" [(ngModel)]="config.res"/>
                </nz-form-control>
            </nz-form-item>
            <nz-divider nzPlain nzText="联动" nzOrientation="center"></nz-divider>
            <nz-form-item>
                <nz-form-label>true时隐藏</nz-form-label>
                <nz-form-control>
                    <input nz-input placeholder="eg: field=='123'" [(ngModel)]="config.cascade"/>
                </nz-form-control>
            </nz-form-item>
            <nz-divider nzPlain nzText="说明" nzOrientation="center"></nz-divider>
            <nz-descriptions nzSize="small" nzTitle="响应字段应包含以下结构">
                <nz-descriptions-item nzTitle="label" [nzSpan]="3">名称</nz-descriptions-item>
                <nz-descriptions-item nzTitle="value" [nzSpan]="3">值</nz-descriptions-item>
                <nz-descriptions-item nzTitle="isLeaf" [nzSpan]="3">是否叶子节点,true/false <span nz-icon nzType="question-circle" nz-tooltip nzTooltipTitle="如果isLeaf为false且无children，组件会再次请求(即懒加载)"></span></nz-descriptions-item>
                <nz-descriptions-item nzTitle="children" [nzSpan]="3">孩子节点,数组</nz-descriptions-item>
            </nz-descriptions>
        </nz-tab>
    </nz-tabset>
</ng-template>
